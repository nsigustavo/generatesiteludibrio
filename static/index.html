<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="pt-br" xmlns="http://www.w3.org/1999/xhtml" lang="pt-br">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="css/global.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="css/python.css" type="text/css" charset="utf-8" />
</head>
<body>

<div id="content">
    <div class="menu">
        <img src="file:///media/KINGSTON/site/img/documentacao.png" />
        <img src="file:///media/KINGSTON/site/img/comunidade.png" />
        <img src="file:///media/KINGSTON/site/img/download.png" />
        <img src="file:///media/KINGSTON/site/img/programando.png" />
        <img src="file:///media/KINGSTON/site/img/lupa.png" />
    </div>

    <div id="search">
        <form action="" method="get">
            <input type="text" name="search" class="searchinput" />
            <input type="submit" value="search" class="submitsearch" />
        </form>
    </div>

    <div class="coluna">
        <h1 class="documentation">Documentation</h1>
        <p>Here, you can find examples showing how to use Ludibrio test double</p>
        <h1 class="install">Install</h1>
        <pre><code>
  $ sudo easy_install ludibrio
        </code></pre>


        <h1  class="development">Getting involved !</h1>

        <p>Ludibrio's development may be viewed and followed on github:</p>

        <pre><code>
  http://github.com/nsigustavo/ludibrio
        </code></pre>

        <p>Retrieve the source code using <i>git</i>:</p>

        <pre><code>    
  git clone git://github.com/nsigustavo/ludibrio.git
        </code></pre>

        <p>Install package in <i>development mode</i> and run tests with <i>doctestcommand</i>.</p>

        <pre><code>
    $ sudo easy_install doctestcommand
    $ git clone git://github.com/nsigustavo/ludibrio.git
    $ cd ludibrio
    $ sudo python setup.py develop
    $ cd ludibrio
    $ doctest
        </code></pre>
    </div>





    <div class="coluna">

        <h2>Mock</h2>

        <p>Mocks are objects pre-programmed with expectations which form a specification of the calls they are expected to receive.</p>

        <p>A Mocker or Stub instance uses the 'with' statement to record and replay expectations:</p>

        <pre>
     <div class="python"><ol>
    <li class="li1"><div class="de2"><span class="sy0">&gt;&gt;&gt;</span> <span class="kw1">from</span> ludibrio <span class="kw1">import</span> Mock</div></li>
    <li class="li2"><div class="de2"><span class="sy0">&gt;&gt;&gt;</span> <span class="kw1">with</span> Mock<span class="br0">(</span><span class="br0">)</span> <span class="kw1">as</span> MySQLdb:</div></li>
    <li class="li1"><div class="de1">... &nbsp; &nbsp; <span class="me1">con</span> = MySQLdb.<span class="me1">connect</span><span class="br0">(</span><span class="st0">'servidor'</span>, <span class="st0">' usuario'</span>, <span class="st0">'senha'</span><span class="br0">)</span></div></li>
    <li class="li2"><div class="de2">... &nbsp; &nbsp; <span class="me1">con</span>.<span class="me1">select_db</span><span class="br0">(</span><span class="st0">'banco de dados'</span><span class="br0">)</span> <span class="sy0">&gt;&gt;</span> <span class="kw2">None</span></div></li>
    <li class="li1"><div class="de1">... &nbsp; &nbsp; <span class="me1">cursor</span> = con.<span class="me1">cursor</span><span class="br0">(</span><span class="br0">)</span></div></li>
    <li class="li2"><div class="de2">... &nbsp; &nbsp; <span class="me1">cursor</span>.<span class="me1">execute</span><span class="br0">(</span><span class="st0">'ALGUM SQL'</span><span class="br0">)</span> <span class="sy0">&gt;&gt;</span> <span class="kw2">None</span></div></li>
    <li class="li1"><div class="de1">... &nbsp; &nbsp; <span class="me1">cursor</span>.<span class="me1">fetchall</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">&gt;&gt;</span> <span class="br0">[</span><span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span>,<span class="nu0">5</span><span class="br0">]</span></div></li>
    <li class="li2"><div class="de2"><span class="sy0">&gt;&gt;&gt;</span> con = MySQLdb.<span class="me1">connect</span><span class="br0">(</span><span class="st0">'servidor'</span>, <span class="st0">' usuario'</span>, <span class="st0">'senha'</span><span class="br0">)</span></div></li>
    <li class="li1"><div class="de1"><span class="sy0">&gt;&gt;&gt;</span> con.<span class="me1">select_db</span><span class="br0">(</span><span class="st0">'banco de dados'</span><span class="br0">)</span></div></li>
    <li class="li2"><div class="de2"><span class="sy0">&gt;&gt;&gt;</span> cursor = con.<span class="me1">cursor</span><span class="br0">(</span><span class="br0">)</span></div></li>
    <li class="li1"><div class="de1"><span class="sy0">&gt;&gt;&gt;</span> cursor.<span class="me1">execute</span><span class="br0">(</span><span class="st0">'ALGUM SQL'</span><span class="br0">)</span></div></li>
    <li class="li2"><div class="de2"><span class="sy0">&gt;&gt;&gt;</span> cursor.<span class="me1">fetchall</span><span class="br0">(</span><span class="br0">)</span></div></li>
    <li class="li1"><div class="de1"><span class="br0">[</span><span class="nu0">1</span>, <span class="nu0">2</span>, <span class="nu0">3</span>, <span class="nu0">4</span>, <span class="nu0">5</span><span class="br0">]</span></div></li>
    <li class="li2"><div class="de1"><span class="sy0">&gt;&gt;&gt;</span> MySQLdb.<span class="me1">validate</span><span class="br0">(</span><span class="br0">)</span> <span class="co1">#passed</span></div></li>
    </ol></div>
    </pre>

        <h2>Stub</h2>

        <p>Stubs provide pre-defined answers to method calls made during a test:</p>

        <pre>
            <code>
    &gt;&gt;&gt; from ludibrio import Stub

    &gt;&gt;&gt; with Stub() as x:
    ...     x.anything() &gt;&gt; 'response'

    &gt;&gt;&gt; x.anything()
    'response'
            </code>
        </pre>

        <h2>Trivial mocking or stubing for any external module</h2>

        <p>Ludibrio
    also offers a replace mode, which basically means if a "from ... import
    ..." statement is defined into a 'with' scope, the replay mechanism
    will return a mock object to replace the original object in namespace
    of the whole Python interpreter (including any modules, etc). There's a
    simple example below to illustrate how use it:</p>

        <pre><code>    
    &gt;&gt;&gt; from ludibrio import Stub

    &gt;&gt;&gt; with Stub() as time:
    ...     from time import time
    ...     time() &gt;&gt; 171

    &gt;&gt;&gt; from time import time
    &gt;&gt;&gt; time()
    171
        </code></pre>

        <h2>Proxy</h2>

        <p>Two
    Ludibrio's powerful features that aren't found in other mocking systems
    is the ability of proxying existing objects, or patching a real
    instance or class.</p>

        <p>When an object is proxied, Ludibrio
    create a Test Double object holding a reference to the real object,
    allowing expressions passthrough to it(mocked or not, and by default or
    on request).</p>

        <pre>
            <code>
    &gt;&gt;&gt; from os.path import splitext

    &gt;&gt;&gt; with Stub(proxy=splitext) as splitext:
    ...     splitext('ludibrio/stubed.py') &gt;&gt; ('/temp/temp','.temp')

    &gt;&gt;&gt; splitext('mock.py')
    ('mock', '.py')

    &gt;&gt;&gt; splitext('ludibrio/stubed.py')
    ('/temp/temp', '.temp')
            </code>
        </pre>
    </div>

</div>
</body></html>
